class WasteRequest:
    """
    Represents an individual waste collection request.

    Note:
        This is intentionally kept simple. If request metadata grows,
        consider moving to a dataclass and/or adding validation.
    """

    _next_id = 1  # Simple in-memory incremental ID generator.

    def __init__(self, waste_type: str, weight_kg: float, location: str):
        # Assign a unique ID. Persistence layer would change this approach.
        self.id = WasteRequest._next_id
        WasteRequest._next_id += 1

        # Core fields
        self.type = waste_type
        self.weight = weight_kg
        self.location = location

        # Base lifecycle status — could become an Enum if statuses expand.
        self.status = "Pending"

    def __str__(self):
        # Compact formatting for logs or CLI output.
        return (
            f"ID: {self.id} | Type: {self.type} | Weight: {self.weight}kg | "
            f"Location: {self.location} | Status: {self.status}"
        )


class WasteManager:
    """
    Manages waste requests and provides simple aggregated statistics.

    Note:
        For now, this class serves both as a controller and in-memory store.
        A proper repository/service split can be done if/when requirements grow.
    """

    def __init__(self):
        # Storing everything in a list — more than enough at this scale.
        self._requests = []

    def add_request(self, request: WasteRequest):
        """Register a new waste request."""
        self._requests.append(request)
        print(f"\n✔ Request {request.id} ({request.type}) registered.")

    def update_status(self, request_id: int, new_status: str):
        """Update the status of a request by ID."""
        req = self._find(request_id)
        if not req:
            print(f"\n✖ No request found with ID {request_id}.")
            return

        req.status = new_status
        print(f"\n↺ Request {request_id} updated → '{new_status}'")

    def view_all_requests(self):
        """Display all stored requests."""
        if not self._requests:
            print("\nℹ No waste requests in the system.")
            return

        print("\n--- Current Waste Requests ---")
        for req in self._requests:
            print(req)
        print("------------------------------")

    def get_statistics(self):
        """Aggregate and print basic waste statistics."""
        if not self._requests:
            print("\nℹ No statistics available — no requests recorded.")
            return

        total_weight = 0.0
        weight_by_type = {}
        status_count = {"Pending": 0, "Scheduled": 0, "Completed": 0}

        for req in self._requests:
            total_weight += req.weight

            # Group by waste type
            weight_by_type[req.type] = weight_by_type.get(req.type, 0.0) + req.weight

            # Track request statuses
            status_count[req.status] = status_count.get(req.status, 0) + 1

        print("\n--- Waste Management Statistics ---")
        print(f"Total Requests: {len(self._requests)}")
        print(f"Total Weight: {total_weight:.2f} kg")

        print("\nWeight by Type:")
        for t, w in weight_by_type.items():
            print(f"- {t}: {w:.2f} kg")

        print("\nRequests by Status:")
        for st, c in status_count.items():
            print(f"- {st}: {c} request(s)")
        print("-----------------------------------")

    # -- Internal helpers --

    def _find(self, request_id: int):
        """Retrieve a request by ID. Returns None if not found."""
        # This could be O(1) with a dict, but simplicity is fine here.
        for req in self._requests:
            if req.id == request_id:
                return req
        return None


# --- Demonstration (basic CLI-style usage) ---

if __name__ == "__main__":

    manager = WasteManager()

    # Register some sample requests.
    r1 = WasteRequest("Recyclable", 15.5, "123 Main St")
    r2 = WasteRequest("General", 22.0, "456 Oak Ave")
    r3 = WasteRequest("Hazardous", 1.2, "789 Pine Ln")

    manager.add_request(r1)
    manager.add_request(r2)
    manager.add_request(r3)

    # Show current state
    manager.view_all_requests()

    # Update statuses
    manager.update_status(1, "Scheduled")
    manager.update_status(2, "Completed")
    manager.update_status(4, "Failed")  # Expected: ID not found

    # Show updated list
    manager.view_all_requests()

    # Show statistics
    manager.get_statistics()